
local syscalls = {}

-- syscall numbers
-- TODO: syscalls.nr = ..
syscalls.read = 0
syscalls.write = 1
syscalls.open = 2
syscalls.close = 3
syscalls.stat = 4
syscalls.fstat = 5
syscalls.lstat = 6
syscalls.poll = 7
syscalls.lseek = 8
syscalls.mmap = 9
syscalls.mprotect = 10
syscalls.munmap = 11
syscalls.brk = 12
syscalls.rt_sigaction = 13
syscalls.rt_sigprocmask = 14
syscalls.rt_sigreturn = 15
syscalls.ioctl = 16
syscalls.pread64 = 17
syscalls.pwrite64 = 18
syscalls.readv = 19
syscalls.writev = 20
syscalls.access = 21
syscalls.pipe = 22
syscalls.select = 23
syscalls.sched_yield = 24
syscalls.mremap = 25
syscalls.msync = 26
syscalls.mincore = 27
syscalls.madvise = 28
syscalls.shmget = 29
syscalls.shmat = 30
syscalls.shmctl = 31
syscalls.dup = 32
syscalls.dup2 = 33
syscalls.pause = 34
syscalls.nanosleep = 35
syscalls.getitimer = 36
syscalls.alarm = 37
syscalls.setitimer = 38
syscalls.getpid = 39
syscalls.sendfile = 40
syscalls.socket = 41
syscalls.connect = 42
syscalls.accept = 43
syscalls.sendto = 44
syscalls.recvfrom = 45
syscalls.sendmsg = 46
syscalls.recvmsg = 47
syscalls.shutdown = 48
syscalls.bind = 49
syscalls.listen = 50
syscalls.getsockname = 51
syscalls.getpeername = 52
syscalls.socketpair = 53
syscalls.setsockopt = 54
syscalls.getsockopt = 55
syscalls.clone = 56
syscalls.fork = 57
syscalls.vfork = 58
syscalls.execve = 59
syscalls.exit = 60
syscalls.wait4 = 61
syscalls.kill = 62
syscalls.uname = 63
syscalls.semget = 64
syscalls.semop = 65
syscalls.semctl = 66
syscalls.shmdt = 67
syscalls.msgget = 68
syscalls.msgsnd = 69
syscalls.msgrcv = 70
syscalls.msgctl = 71
syscalls.fcntl = 72
syscalls.flock = 73
syscalls.fsync = 74
syscalls.fdatasync = 75
syscalls.truncate = 76
syscalls.ftruncate = 77
syscalls.getdents = 78
syscalls.getcwd = 79
syscalls.chdir = 80
syscalls.fchdir = 81
syscalls.rename = 82
syscalls.mkdir = 83
syscalls.rmdir = 84
syscalls.creat = 85
syscalls.link = 86
syscalls.unlink = 87
syscalls.symlink = 88
syscalls.readlink = 89
syscalls.chmod = 90
syscalls.fchmod = 91
syscalls.chown = 92
syscalls.fchown = 93
syscalls.lchown = 94
syscalls.umask = 95
syscalls.gettimeofday = 96
syscalls.getrlimit = 97
syscalls.getrusage = 98
syscalls.sysinfo = 99
syscalls.times = 100
syscalls.ptrace = 101
syscalls.getuid = 102
syscalls.syslog = 103
syscalls.getgid = 104
syscalls.setuid = 105
syscalls.setgid = 106
syscalls.geteuid = 107
syscalls.getegid = 108
syscalls.setpgid = 109
syscalls.getppid = 110
syscalls.getpgrp = 111
syscalls.setsid = 112
syscalls.setreuid = 113
syscalls.setregid = 114
syscalls.getgroups = 115
syscalls.setgroups = 116
syscalls.setresuid = 117
syscalls.getresuid = 118
syscalls.setresgid = 119
syscalls.getresgid = 120
syscalls.getpgid = 121
syscalls.setfsuid = 122
syscalls.setfsgid = 123
syscalls.getsid = 124
syscalls.capget = 125
syscalls.capset = 126
syscalls.rt_sigpending = 127
syscalls.rt_sigtimedwait = 128
syscalls.rt_sigqueueinfo = 129
syscalls.rt_sigsuspend = 130
syscalls.sigaltstack = 131
syscalls.utime = 132
syscalls.mknod = 133
syscalls.uselib = 134
syscalls.personality = 135
syscalls.ustat = 136
syscalls.statfs = 137
syscalls.fstatfs = 138
syscalls.sysfs = 139
syscalls.getpriority = 140
syscalls.setpriority = 141
syscalls.sched_setparam = 142
syscalls.sched_getparam = 143
syscalls.sched_setscheduler = 144
syscalls.sched_getscheduler = 145
syscalls.sched_get_priority_max = 146
syscalls.sched_get_priority_min = 147
syscalls.sched_rr_get_interval = 148
syscalls.mlock = 149
syscalls.munlock = 150
syscalls.mlockall = 151
syscalls.munlockall = 152
syscalls.vhangup = 153
syscalls.modify_ldt = 154
syscalls.pivot_root = 155
syscalls._sysctl = 156
syscalls.prctl = 157
syscalls.arch_prctl = 158
syscalls.adjtimex = 159
syscalls.setrlimit = 160
syscalls.chroot = 161
syscalls.sync = 162
syscalls.acct = 163
syscalls.settimeofday = 164
syscalls.mount = 165
syscalls.umount2 = 166
syscalls.swapon = 167
syscalls.swapoff = 168
syscalls.reboot = 169
syscalls.sethostname = 170
syscalls.setdomainname = 171
syscalls.iopl = 172
syscalls.ioperm = 173
syscalls.create_module = 174
syscalls.init_module = 175
syscalls.delete_module = 176
syscalls.get_kernel_syms = 177
syscalls.query_module = 178
syscalls.quotactl = 179
syscalls.nfsservctl = 180
syscalls.getpmsg = 181
syscalls.putpmsg = 182
syscalls.afs_syscall = 183
syscalls.tuxcall = 184
syscalls.security = 185
syscalls.gettid = 186
syscalls.readahead = 187
syscalls.setxattr = 188
syscalls.lsetxattr = 189
syscalls.fsetxattr = 190
syscalls.getxattr = 191
syscalls.lgetxattr = 192
syscalls.fgetxattr = 193
syscalls.listxattr = 194
syscalls.llistxattr = 195
syscalls.flistxattr = 196
syscalls.removexattr = 197
syscalls.lremovexattr = 198
syscalls.fremovexattr = 199
syscalls.tkill = 200
syscalls.time = 201
syscalls.futex = 202
syscalls.sched_setaffinity = 203
syscalls.sched_getaffinity = 204
syscalls.set_thread_area = 205
syscalls.io_setup = 206
syscalls.io_destroy = 207
syscalls.io_getevents = 208
syscalls.io_submit = 209
syscalls.io_cancel = 210
syscalls.get_thread_area = 211
syscalls.lookup_dcookie = 212
syscalls.epoll_create = 213
syscalls.epoll_ctl_old = 214
syscalls.epoll_wait_old = 215
syscalls.remap_file_pages = 216
syscalls.getdents64 = 217
syscalls.set_tid_address = 218
syscalls.restart_syscall = 219
syscalls.semtimedop = 220
syscalls.fadvise64 = 221
syscalls.timer_create = 222
syscalls.timer_settime = 223
syscalls.timer_gettime = 224
syscalls.timer_getoverrun = 225
syscalls.timer_delete = 226
syscalls.clock_settime = 227
syscalls.clock_gettime = 228
syscalls.clock_getres = 229
syscalls.clock_nanosleep = 230
syscalls.exit_group = 231
syscalls.epoll_wait = 232
syscalls.epoll_ctl = 233
syscalls.tgkill = 234
syscalls.utimes = 235
syscalls.vserver = 236
syscalls.mbind = 237
syscalls.set_mempolicy = 238
syscalls.get_mempolicy = 239
syscalls.mq_open = 240
syscalls.mq_unlink = 241
syscalls.mq_timedsend = 242
syscalls.mq_timedreceive = 243
syscalls.mq_notify = 244
syscalls.mq_getsetattr = 245
syscalls.kexec_load = 246
syscalls.waitid = 247
syscalls.add_key = 248
syscalls.request_key = 249
syscalls.keyctl = 250
syscalls.ioprio_set = 251
syscalls.ioprio_get = 252
syscalls.inotify_init = 253
syscalls.inotify_add_watch = 254
syscalls.inotify_rm_watch = 255
syscalls.migrate_pages = 256
syscalls.openat = 257
syscalls.mkdirat = 258
syscalls.mknodat = 259
syscalls.fchownat = 260
syscalls.futimesat = 261
syscalls.newfstatat = 262
syscalls.unlinkat = 263
syscalls.renameat = 264
syscalls.linkat = 265
syscalls.symlinkat = 266
syscalls.readlinkat = 267
syscalls.fchmodat = 268
syscalls.faccessat = 269
syscalls.pselect6 = 270
syscalls.ppoll = 271
syscalls.unshare = 272
syscalls.set_robust_list = 273
syscalls.get_robust_list = 274
syscalls.splice = 275
syscalls.tee = 276
syscalls.sync_file_range = 277
syscalls.vmsplice = 278
syscalls.move_pages = 279
syscalls.utimensat = 280
syscalls.epoll_pwait = 281
syscalls.signalfd = 282
syscalls.timerfd_create = 283
syscalls.eventfd = 284
syscalls.fallocate = 285
syscalls.timerfd_settime = 286
syscalls.timerfd_gettime = 287
syscalls.accept4 = 288
syscalls.signalfd4 = 289
syscalls.eventfd2 = 290
syscalls.epoll_create1 = 291
syscalls.dup3 = 292
syscalls.pipe2 = 293
syscalls.inotify_init1 = 294
syscalls.preadv = 295
syscalls.pwritev = 296
syscalls.rt_tgsigqueueinfo = 297
syscalls.perf_event_open = 298
syscalls.recvmmsg = 299
syscalls.fanotify_init = 300
syscalls.fanotify_mark = 301
syscalls.prlimit64 = 302
syscalls.name_to_handle_at = 303
syscalls.open_by_handle_at = 304
syscalls.clock_adjtime = 305
syscalls.syncfs = 306
syscalls.sendmmsg = 307
syscalls.setns = 308
syscalls.getcpu = 309
syscalls.process_vm_readv = 310
syscalls.process_vm_writev = 311
syscalls.kcmp = 312
syscalls.finit_module = 313
syscalls.sched_setattr = 314
syscalls.sched_getattr = 315
syscalls.renameat2 = 316
syscalls.seccomp = 317
syscalls.getrandom = 318
syscalls.memfd_create = 319
syscalls.kexec_file_load = 320
syscalls.bpf = 321
syscalls.execveat = 322
syscalls.userfaultfd = 323
syscalls.membarrier = 324
syscalls.mlock2 = 325
syscalls.copy_file_range = 326
syscalls.preadv2 = 327
syscalls.pwritev2 = 328
syscalls.pkey_mprotect = 329
syscalls.pkey_alloc = 330
syscalls.pkey_free = 331
syscalls.statx = 332

--[[

POC: describe each calls arguments

-- data types
syscalls.epoll_event = nil
syscalls.iattr = nil
syscalls.inode = nil
syscalls.iocb = nil
syscalls.io_event = nil
syscalls.iovec = nil
syscalls.itimerspec = nil
syscalls.itimerval = nil
syscalls.kexec_segment = nil
syscalls.linux_dirent = nil
syscalls.linux_dirent64 = nil
syscalls.list_head = nil
syscalls.mmap_arg_struct = nil
syscalls.msgbuf = nil
syscalls.user_msghdr = nil
syscalls.mmsghdr = nil
syscalls.msqid_ds = nil
syscalls.new_utsname = nil
syscalls.nfsctl_arg = nil
syscalls.__old_kernel_stat = nil
syscalls.oldold_utsname = nil
syscalls.old_utsname = nil
syscalls.pollfd = nil
syscalls.rlimit = nil
syscalls.rlimit64 = nil
syscalls.rusage = nil
syscalls.sched_param = nil
syscalls.sched_attr = nil
syscalls.sel_arg_struct = nil
syscalls.semaphore = nil
syscalls.sembuf = nil
syscalls.shmid_ds = nil
syscalls.sockaddr = nil
syscalls.stat = nil
syscalls.stat64 = nil
syscalls.statfs = nil
syscalls.statfs64 = nil
syscalls.statx = nil
syscalls.__sysctl_args = nil
syscalls.sysinfo = nil
syscalls.timespec = nil
syscalls.timeval = nil
syscalls.timex = nil
syscalls.timezone = nil
syscalls.tms = nil
syscalls.utimbuf = nil
syscalls.mq_attr = nil
syscalls.compat_stat = nil
syscalls.compat_timeval = nil
syscalls.robust_list_head = nil
syscalls.getcpu_cache = nil
syscalls.old_linux_dirent = nil
syscalls.perf_event_attr = nil
syscalls.file_handle = nil
syscalls.sigaltstack = nil
syscalls.bpf_attr = nil

syscalls.pid = 111
syscalls.sched_attr = 222
syscalls.sched_attr_size = 333
syscalls.sched_flags = 444

-- types of args
syscalls.descriptions = {
    [syscalls.sched_getattr] = {
        -- maybe [-1] = return type
        [1] = syscalls.pid,
        [2] = syscalls.sched_attr,
        [3] = syscalls.sched_attr_size,
        [4] = syscalls.sched_flags
    },
    [syscalls.sched_setattr] = {
        [1] = syscalls.pid,
        [2] = syscalls.sched_attr,
        [3] = syscalls.sched_flags
    }
}
for i,v in pairs(sys.descriptions) do
    print("call #"..i.." "..#v.." args")
    for x,y in ipairs(v) do
        print(x.." -> "..y)
    end
end
]]

return syscalls
